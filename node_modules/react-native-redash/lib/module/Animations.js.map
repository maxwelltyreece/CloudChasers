{"version":3,"names":["defineAnimation","withPause","_nextAnimation","paused","nextAnimation","onFrame","state","now","lastTimestamp","elapsed","value","dt","finished","current","onStart","previousState","callback","isHigherOrder","previousAnimation","startTime","started","withBouncing","lowerBound","upperBound","velocity","_state"],"sources":["Animations.ts"],"sourcesContent":["/* eslint-disable @typescript-eslint/consistent-type-imports */\nimport type { AnimatableValue, Animation } from \"react-native-reanimated\";\nimport Animated, { defineAnimation } from \"react-native-reanimated\";\n\ninterface PausableAnimation extends Animation<PausableAnimation> {\n  lastTimestamp: number;\n  elapsed: number;\n}\n\nexport const withPause = (\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  _nextAnimation: any,\n  paused: Animated.SharedValue<boolean>\n) => {\n  \"worklet\";\n  return defineAnimation<PausableAnimation>(_nextAnimation, () => {\n    \"worklet\";\n    const nextAnimation: PausableAnimation =\n      typeof _nextAnimation === \"function\" ? _nextAnimation() : _nextAnimation;\n    const onFrame = (state: PausableAnimation, now: number) => {\n      const { lastTimestamp, elapsed } = state;\n      if (paused.value) {\n        state.elapsed = now - lastTimestamp;\n        return false;\n      }\n      const dt = now - elapsed;\n      const finished = nextAnimation.onFrame(nextAnimation, dt);\n      state.current = nextAnimation.current;\n      state.lastTimestamp = dt;\n      return finished;\n    };\n    const onStart = (\n      state: PausableAnimation,\n      value: AnimatableValue,\n      now: number,\n      previousState: PausableAnimation\n    ) => {\n      state.lastTimestamp = now;\n      state.elapsed = 0;\n      state.current = 0;\n      nextAnimation.onStart(nextAnimation, value, now, previousState);\n    };\n    const callback = (finished?: boolean): void => {\n      if (nextAnimation.callback) {\n        nextAnimation.callback(finished);\n      }\n    };\n    return {\n      onFrame,\n      onStart,\n      isHigherOrder: true,\n      current: nextAnimation.current,\n      callback,\n      previousAnimation: null,\n      startTime: 0,\n      started: false,\n      lastTimestamp: 0,\n      elapsed: 0,\n    };\n  });\n};\n\nexport interface PhysicsAnimation extends Animation<PhysicsAnimation> {\n  velocity: number;\n  current: number;\n}\n\n/**\n *  @summary Add a bouncing behavior to a physics-based animation.\n *  An animation is defined as being physics-based if it contains a velocity in its state.\n *  @example\n    // will bounce if the animations hits the position 0 or 100\n    withBouncing(withDecay({ velocity }), 0, 100)\n * @worklet\n */\nexport const withBouncing = (\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  _nextAnimation: any,\n  lowerBound: number,\n  upperBound: number\n): number => {\n  \"worklet\";\n  return defineAnimation<PhysicsAnimation>(_nextAnimation, () => {\n    \"worklet\";\n\n    const nextAnimation: PhysicsAnimation =\n      typeof _nextAnimation === \"function\" ? _nextAnimation() : _nextAnimation;\n\n    const onFrame = (state: PhysicsAnimation, now: number) => {\n      const finished = nextAnimation.onFrame(nextAnimation, now);\n      const { velocity, current } = nextAnimation;\n      state.current = current;\n      if (\n        (velocity < 0 && state.current <= lowerBound) ||\n        (velocity > 0 && state.current >= upperBound)\n      ) {\n        state.current = velocity < 0 ? lowerBound : upperBound;\n        nextAnimation.velocity *= -0.5;\n      }\n      return finished;\n    };\n    const onStart = (\n      _state: PhysicsAnimation,\n      value: number,\n      now: number,\n      previousState: PhysicsAnimation\n    ) => {\n      nextAnimation.onStart(nextAnimation, value, now, previousState);\n    };\n    return {\n      onFrame,\n      onStart,\n      current: nextAnimation.current,\n      callback: nextAnimation.callback,\n      velocity: 0,\n    };\n  });\n};\n"],"mappings":"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"}